---
title: Architecture
description: Understanding Positron's technical architecture and design
---

# Architecture

Positron follows Electron's process model, providing a familiar architecture for desktop application development.

## Process Model

```
┌─────────────────────────────────────────┐
│         Main Process (Python)           │
│                                         │
│  ┌───────────┐      ┌────────────┐    │
│  │    App    │──────│ IPC Main   │    │
│  └───────────┘      └────────────┘    │
│         │                   │          │
│         │                   │          │
│  ┌──────▼───────────────────▼───────┐ │
│  │      BrowserWindow(s)             │ │
│  └───────────────────────────────────┘ │
└──────────────────┬──────────────────────┘
                   │
                   │ IPC Bridge
                   │
┌──────────────────▼──────────────────────┐
│   Renderer Process (WebView)            │
│   Real Browser Engine                   │
│                                         │
│  ┌─────────────────────────────────┐  │
│  │         React App                │  │
│  │                                  │  │
│  │  - Full React Support            │  │
│  │  - Modern JavaScript (ES6+)      │  │
│  │  - HTML5 / CSS3                  │  │
│  │  - IPC Renderer API              │  │
│  └─────────────────────────────────┘  │
└─────────────────────────────────────────┘
```

## Main Process (Python)

**Responsibilities:**
- Application lifecycle management
- Window creation and control
- IPC message handling
- Access to full Python ecosystem
- System-level operations

**Key Components:**
- `App`: Singleton managing application lifecycle
- `BrowserWindow`: Window creation and management
- `ipc_main`: IPC communication handler
- `DevServer`: Development server integration

## Renderer Process (WebView)

**Responsibilities:**
- Rendering your React application
- Executing modern JavaScript (full ES6+)
- Displaying HTML5/CSS3 content
- Sending IPC messages to main process
- Isolated from main process for security

**Technologies:**
- **pywebview**: Cross-platform webview wrapper
- **WebView2** (Windows): Chromium-based Edge engine
- **WebKit** (macOS): System browser engine
- **GTK WebKit** (Linux): WebKit2GTK engine
- **React**: UI framework (fully supported!)

## Data Flow

### 1. App Startup

```python
from positron import App, BrowserWindow

app = App()

def create_window():
    win = BrowserWindow({'width': 800, 'height': 600})
    win.load_url('http://localhost:5173')

app.when_ready(create_window)
app.run()  # Starts Tkinter main loop
```

**Flow:**
1. `app.run()` starts Tkinter main loop
2. Emits `ready` event
3. Create windows callback executes
4. Windows are registered with App

### 2. Window Creation

```python
win = BrowserWindow({
    'width': 1000,
    'height': 700,
    'title': 'My App'
})
```

**Flow:**
1. BrowserWindow creates Tk window
2. Embeds pywebview window
3. Registers with App
4. Injects IPC renderer script

### 3. Loading Content

<Tabs items={['Development', 'Production']}>
  <Tab value="Development">
    ```python
    dev_server = DevServer(
        cwd=str(Path(__file__).parent),
        command='npm run dev',
        port=5173
    )
    dev_server.start()
    win.load_url(dev_server.get_url())
    ```
    
    - Starts Vite dev server
    - Loads URL from dev server
    - Enables hot module replacement
  </Tab>
  
  <Tab value="Production">
    ```python
    win.load_file('dist/index.html')
    ```
    
    - Loads built HTML files
    - No dev server needed
    - Optimized bundle
  </Tab>
</Tabs>

### 4. IPC Communication

**Renderer to Main:**

```jsx
// React component
const result = await window.ipcRenderer.invoke('get-data', 'hello')
```

**Main Process Handler:**

```python
from positron.ipc import ipc_main

@ipc_main.handle('get-data')
def handle_get_data(event, arg):
    return f"Python received: {arg}"
```

**Flow:**
1. Renderer calls `ipcRenderer.invoke`
2. Message sent to Python via title/event system
3. IPC Main dispatches to handler
4. Handler processes and returns result
5. Result sent back to renderer

### 5. App Shutdown

**Flow:**
1. User closes window → `closed` event
2. Window unregistered from App
3. If no windows left → `window-all-closed`
4. `App.quit()` → `before-quit` → cleanup → `quit`
5. Tkinter loop exits

## Core Components

### App (positron/main/app.py)

Singleton application instance managing lifecycle.

**Features:**
- Event system (`ready`, `window-all-closed`, `before-quit`, `quit`)
- Window registry
- Main event loop
- Graceful shutdown

```python
app = App()
app.on('ready', callback)
app.when_ready(callback)
app.run()
app.quit()
```

### BrowserWindow (positron/main/browser_window.py)

Window creation and management.

**Features:**
- Tkinter window wrapper
- pywebview integration for rendering
- Window configuration (size, position, title, etc.)
- Preload script injection
- Event handling

```python
win = BrowserWindow(options)
win.load_url(url)
win.load_file(path)
win.load_html(html)
win.show() / hide() / close()
win.on('closed', callback)
```

### IPC System (positron/ipc/)

Bidirectional communication between Python and JavaScript.

**Main Process (Python):**
```python
from positron.ipc import ipc_main

@ipc_main.handle('channel')
def handler(event, *args):
    return result

ipc_main.on('channel', handler)
event.reply('channel', data)
```

**Renderer Process (JavaScript):**
```javascript
window.ipcRenderer.send('channel', ...args)
const result = await window.ipcRenderer.invoke('channel', arg)
ipcRenderer.on('channel', callback)
```

### DevServer (positron/renderer/dev_server.py)

Development server integration.

**Features:**
- Automatic process management
- Port checking and waiting
- Output streaming
- Context manager support

```python
dev_server = DevServer(cwd, command, port)
dev_server.start()
url = dev_server.get_url()
dev_server.stop()
```

## Project Structure

```
positron/
│
├── positron/                    # Core framework
│   ├── __init__.py             # Main exports
│   │
│   ├── main/                   # Main process
│   │   ├── app.py              # App lifecycle
│   │   └── browser_window.py  # Window management
│   │
│   ├── ipc/                    # IPC
│   │   ├── main.py             # IPC main handler
│   │   └── renderer.py         # IPC renderer bridge
│   │
│   ├── renderer/               # Renderer utilities
│   │   └── dev_server.py       # Dev server integration
│   │
│   └── common/                 # Shared utilities
│       └── utilities.py        # Helpers
│
└── examples/
    └── react-app/              # Example app
        ├── main.py             # Entry point
        ├── package.json        # Dependencies
        └── src/
            └── App.jsx         # React app
```

## Technologies Used

| Component | Technology | Purpose |
|-----------|-----------|---------|
| Backend | Python 3.8+ | Main process language |
| Webview Wrapper | pywebview | Cross-platform webview |
| Windows Engine | WebView2 (Chromium) | Modern browser on Windows |
| macOS Engine | WebKit | System browser on macOS |
| Linux Engine | WebKit2GTK | Browser on Linux |
| JavaScript | Full V8/JavaScriptCore | Modern JS execution |
| UI Framework | React 18 | Frontend framework |
| Build Tool | Vite 5 | Dev server and bundling |

## Advantages

✅ **Small bundle size** (~5-10MB vs Electron's ~150MB)
✅ **Lower memory usage** (uses system webview)
✅ **Full Python ecosystem**
✅ **Native Python integration**
✅ **Familiar Electron API**
✅ **Fast development with Vite**
✅ **Full HTML5/CSS3/JavaScript support**
✅ **Real React compatibility**

## Capabilities

✅ Modern web standards (HTML5, CSS3, ES6+)
✅ Full React with hooks, context, everything
✅ CSS Grid, Flexbox, animations
✅ Modern JavaScript features
✅ WebSockets, Fetch API, etc.
⚠️ Platform-dependent features (check webview docs)

## Use Cases

Positron is perfect for:

- **Data science dashboards**: Combine pandas, numpy with React UI
- **Machine learning tools**: TensorFlow/PyTorch backend with modern frontend
- **Automation interfaces**: System automation with beautiful UI
- **Desktop utilities**: Tools that need both Python libraries and web tech
- **Internal tools**: Enterprise apps leveraging existing Python infrastructure

## Comparison with Electron

| Aspect | Electron | Positron |
|--------|----------|----------|
| Main Process | Node.js | Python |
| Renderer | Chromium | System WebView |
| Bundle Size | ~150MB | ~10MB |
| Memory | High | Low |
| Backend Ecosystem | npm | PyPI |
| Web Standards | Full HTML5/CSS3 | HTML 4.01/CSS 2.1 |
| API Compatibility | N/A | Electron-like |

## Next Steps

- [App API Reference](/docs/api/app)
- [BrowserWindow API](/docs/api/browser-window)
- [IPC Communication](/docs/api/ipc)
